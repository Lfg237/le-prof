<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Interactif √âducatif</title>
<style>
body { font-family: Arial,sans-serif; margin:0; padding:0; background: linear-gradient(-45deg,#1e3c72,#2a5298,#f6d365,#fda085); background-size:400% 400%; animation: gradientBG 15s ease infinite; color:#fff; }
@keyframes gradientBG {0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
header { text-align:center; padding:20px; }
#datetime { font-size:1.1em; margin-top:5px; }
main { max-width:700px; margin:0 auto; padding:20px; background:rgba(0,0,0,0.4); border-radius:15px; }
section { margin-bottom:20px; padding:15px; background:rgba(255,255,255,0.1); border-radius:10px; }
select, button, input { padding:10px; margin-top:10px; border:none; border-radius:10px; font-weight:bold; }
button { background:#ff7f50; color:#fff; cursor:pointer; transition:0.3s; }
button:hover { background:#ff4500; transform:scale(1.05); }
input { width:60%; margin-right:10px; }
#quizContainer { margin-top:20px; }
#result { font-weight:bold; font-size:1.2em; margin-top:10px; }
.correct { color:lightgreen; animation: blink 0.5s; }
.incorrect { color:orange; animation: blink 0.5s; }
@keyframes blink { 0%{opacity:0.2} 50%{opacity:1} 100%{opacity:0.2} }

/* Popup mauvaise r√©ponse */
#wrongAnswerPopup {
  display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
  background:rgba(0,0,0,0.7); justify-content:center; align-items:center; z-index:1000;
}
#wrongAnswerPopup div {
  background:#fff; color:#000; padding:20px; border-radius:10px; max-width:400px; text-align:center;
}
#wrongAnswerPopup button {
  padding:10px 20px; border:none; border-radius:10px; background:#ff7f50; color:#fff; cursor:pointer;
}
</style>
</head>
<body>

<header>
<h1 id="siteTitle">üìö Quiz Interactif</h1>
<p id="datetime"></p>
<label id="langLabel" for="langSelect">Langue :</label>
<select id="langSelect" onchange="updateLanguage()">
  <option value="fr">Fran√ßais</option>
  <option value="en">English</option>
  <option value="es">Espa√±ol</option>
  <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
</select>
</header>

<main>
<section id="selection">
<h2 id="selectTitle">Choisir Classe et Mati√®re</h2>
<label id="classeLabel" for="classeSelect">Classe :</label>
<select id="classeSelect">
  <option value="">--Choisir une classe--</option>
  <option value="CM2">CM2</option>
  <option value="6√®me">6√®me</option>
  <option value="5√®me">5√®me</option>
  <option value="4√®me">4√®me</option>
  <option value="3√®me">3√®me</option>
</select>
<label id="matiereLabel" for="matiereSelect">Mati√®re :</label>
<select id="matiereSelect">
  <option value="">--Choisir une mati√®re--</option>
  <option value="Math√©matiques">Math√©matiques</option>
  <option value="Fran√ßais">Fran√ßais</option>
  <option value="Sciences">Sciences</option>
  <option value="Histoire">Histoire</option>
</select>
</section>

<section id="coursSection">
<h2 id="coursTitle">üí° Cours</h2>
<div id="coursList"></div>
</section>

<section id="quizSection">
<h2 id="quizTitle">üìù Question</h2>
<div id="quizContainer">
  <p id="questionText"></p>
  <input type="text" id="answerInput" placeholder="">
  <button id="answerBtn" onclick="submitAnswer()">R√©pondre</button>
  <p id="result"></p>
</div>
</section>
</main>

<footer>
&copy; 2025 Mon Site √âducatif
</footer>

<div id="wrongAnswerPopup">
  <div>
    <p id="correctAnswerText"></p>
    <button onclick="closeWrongAnswerPopup()">Fermer</button>
  </div>
</div>

<script>
// --- Heure locale ---
function updateDateTime(){
  const now = new Date();
  document.getElementById('datetime').innerText = now.toLocaleDateString('fr-FR',{weekday:'long',year:'numeric',month:'long',day:'numeric'})+' | '+now.toLocaleTimeString('fr-FR');
}
setInterval(updateDateTime,1000);
updateDateTime();

// --- M√©moire locale ---
let answeredCount = parseInt(localStorage.getItem("answeredCount")) || 0;
let lastActivity = localStorage.getItem("lastActivity") || null;

// --- Param√®tre blocage et paiement ---
const MAX_QUESTIONS_BEFORE_PAYMENT = 2; // facile √† changer

// --- Donn√©es ---
const coursData = {
"CM2":{"Math√©matiques":["Addition","Soustraction"],"Fran√ßais":["Grammaire","Lecture"],"Sciences":["Animaux","Plantes"],"Histoire":["Pr√©histoire","Antiquit√©"]},
"6√®me":{"Math√©matiques":["Nombres","G√©om√©trie"],"Fran√ßais":["Grammaire","Lecture"],"Sciences":["Animaux","Plantes"],"Histoire":["Pr√©histoire","Antiquit√©"]},
"5√®me":{"Math√©matiques":["Fractions","D√©cimaux"],"Fran√ßais":["Orthographe","Po√©sie"],"Sciences":["Physique","Chimie"],"Histoire":["Moyen-√Çge","Renaissance"]},
"4√®me":{"Math√©matiques":["Alg√®bre","G√©om√©trie"],"Fran√ßais":["Lecture","Conjugaison"],"Sciences":["Biologie","Physique"],"Histoire":["R√©volution","Empire"]},
"3√®me":{"Math√©matiques":["Fonctions","Probabilit√©s"],"Fran√ßais":["Expression","Vocabulaire"],"Sciences":["Chimie","Astronomie"],"Histoire":["√âpoque contemporaine","Guerres mondiales"]}
};

let currentQuiz = [];
let currentIndex = 0;
let questionsDone = answeredCount;

// --- Textes multilingues ---
const texts = {
  fr: { siteTitle:"üìö Quiz Interactif", selectTitle:"Choisir Classe et Mati√®re", classe:"Classe :", matiere:"Mati√®re :", coursTitle:"üí° Cours", quizTitle:"üìù Question", answerPlaceholder:"Votre r√©ponse", answerBtn:"R√©pondre", completeMsg:"üéâ Quiz termin√© !"},
  en: { siteTitle:"üìö Interactive Quiz", selectTitle:"Select Class and Subject", classe:"Class :", matiere:"Subject :", coursTitle:"üí° Lessons", quizTitle:"üìù Question", answerPlaceholder:"Your answer", answerBtn:"Submit", completeMsg:"üéâ Quiz Finished!"},
  es: { siteTitle:"üìö Quiz Interactivo", selectTitle:"Elegir Clase y Materia", classe:"Clase :", matiere:"Materia :", coursTitle:"üí° Cursos", quizTitle:"üìù Pregunta", answerPlaceholder:"Tu respuesta", answerBtn:"Responder", completeMsg:"üéâ ¬°Quiz Terminado!"},
  ar: { siteTitle:"üìö ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ™ŸÅÿßÿπŸÑŸä", selectTitle:"ÿßÿÆÿ™ÿ± ÿßŸÑÿµŸÅ ŸàÿßŸÑŸÖÿßÿØÿ©", classe:"ÿßŸÑÿµŸÅ :", matiere:"ÿßŸÑŸÖÿßÿØÿ© :", coursTitle:"üí° ÿßŸÑÿØÿ±Ÿàÿ≥", quizTitle:"üìù ÿßŸÑÿ≥ÿ§ÿßŸÑ", answerPlaceholder:"ÿ•ÿ¨ÿßÿ®ÿ™ŸÉ", answerBtn:"ÿ£ÿ¨ÿ®", completeMsg:"üéâ ÿßŸÜÿ™ŸáŸâ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±!"}
};

// --- Traductions des questions ---
const translations = {
  "Combien font 12 + 8 ?": { en:"How much is 12 + 8?", es:"¬øCu√°nto es 12 + 8?", ar:"ŸÉŸÖ Ÿäÿ≥ÿßŸàŸä 12 + 8ÿü" },
  "Combien font 15 - 7 ?": { en:"How much is 15 - 7?", es:"¬øCu√°nto es 15 - 7?", ar:"ŸÉŸÖ Ÿäÿ≥ÿßŸàŸä 15 - 7ÿü" },
  "Synonyme de 'rapide' ?": { en:"Synonym of 'rapide'?", es:"Sin√≥nimo de 'r√°pido'?", ar:"ŸÖÿ±ÿßÿØŸÅ 'ÿ≥ÿ±Ÿäÿπ'ÿü" },
  "Pluriel de 'cheval' ?": { en:"Plural of 'cheval'?", es:"Plural de 'caballo'?", ar:"ÿ¨ŸÖÿπ 'ÿ≠ÿµÿßŸÜ'ÿü" }
  // Ajouter d'autres questions ici avec leur traduction
};

// --- Fonctions ---
document.getElementById('classeSelect').addEventListener('change', startQuizIfSelected);
document.getElementById('matiereSelect').addEventListener('change', startQuizIfSelected);

function startQuizIfSelected(){
  const classe = document.getElementById('classeSelect').value;
  const matiere = document.getElementById('matiereSelect').value;
  if(!classe || !matiere) return;

  const coursList = document.getElementById('coursList');
  coursList.innerHTML = "";
  (coursData[classe][matiere]||[]).forEach(c => { const div=document.createElement('div'); div.innerText=c; coursList.appendChild(div); });

  currentQuiz = generateQuiz(classe, matiere);
  currentIndex = 0;
  showQuestion();
}

function generateQuiz(classe, matiere){
  const quizBank = {
    "CM2": {
      "Math√©matiques": [
        {q: "Combien font 12 + 8 ?", a: "20"},
        {q: "Combien font 15 - 7 ?", a: "8"}
      ],
      "Fran√ßais": [
        {q: "Synonyme de 'rapide' ?", a: "vite"},
        {q: "Pluriel de 'cheval' ?", a: "chevaux"}
      ]
    },
    "6√®me": {
      "Math√©matiques": [
        {q: "5 + 3 ?", a: "8"},
        {q: "2 x 4 ?", a: "8"}
      ],
      "Fran√ßais": [
        {q: "Synonyme de 'grand' ?", a: "haut"},
        {q: "Antonyme de 'jour' ?", a: "nuit"}
      ]
    }
  };
  return (quizBank[classe] && quizBank[classe][matiere]) ? quizBank[classe][matiere] : [];
}

function showQuestion(){
  if(currentIndex >= currentQuiz.length){
    document.getElementById('quizContainer').innerHTML = texts[document.getElementById('langSelect').value].completeMsg;
    return;
  }
  const lang = document.getElementById('langSelect').value;
  const q = currentQuiz[currentIndex].q;
  document.getElementById('questionText').innerText = (translations[q] && translations[q][lang]) ? translations[q][lang] : q;
  document.getElementById('answerInput').value = "";
  document.getElementById('answerInput').placeholder = texts[lang].answerPlaceholder;
  document.getElementById('answerBtn').innerText = texts[lang].answerBtn;
  document.getElementById('result').innerText = "";
}

function submitAnswer(){
  const answer = document.getElementById('answerInput').value.trim().toLowerCase();
  const correct = currentQuiz[currentIndex].a.toLowerCase();
  const resultEl = document.getElementById('result');

  if(answer === correct){
    resultEl.innerText = "‚úÖ Correct !";
    resultEl.className = "correct";
  } else {
    resultEl.innerText = "‚ùå Incorrect !";
    resultEl.className = "incorrect";
    document.getElementById('correctAnswerText').innerText = `La bonne r√©ponse est : ${currentQuiz[currentIndex].a}`;
    document.getElementById('wrongAnswerPopup').style.display = "flex";
  }

  currentIndex++;
  questionsDone++;

  // --- Sauvegarde m√©moire ---
  localStorage.setItem("answeredCount", questionsDone);
  localStorage.setItem("lastActivity", new Date().toISOString());

  // --- V√©rifier si on atteint le blocage ---
  if(questionsDone >= MAX_QUESTIONS_BEFORE_PAYMENT){
    document.getElementById('quizContainer').innerHTML = `
      <p>üéâ Vous avez atteint ${MAX_QUESTIONS_BEFORE_PAYMENT} questions !</p>
      <p>Pour continuer le quiz, veuillez effectuer le paiement.</p>
      <iframe src="https://www.my-coolpay.com/pay/ciWsFgwN" 
              style="width:100%; height:600px; border:none;"></iframe>
    `;
  } else {
    setTimeout(showQuestion, 1000);
  }
}

function closeWrongAnswerPopup(){
  document.getElementById('wrongAnswerPopup').style.display = "none";
}

function updateLanguage(){
  const lang = document.getElementById('langSelect').value;
  document.getElementById('siteTitle').innerText = texts[lang].siteTitle;
  document.getElementById('selectTitle').innerText = texts[lang].selectTitle;
  document.getElementById('classeLabel').innerText = texts[lang].classe;
  document.getElementById('matiereLabel').innerText = texts[lang].matiere;
  document.getElementById('coursTitle').innerText = texts[lang].coursTitle;
  document.getElementById('quizTitle').innerText = texts[lang].quizTitle;
  document.getElementById('answerInput').placeholder = texts[lang].answerPlaceholder;
  document.getElementById('answerBtn').innerText = texts[lang].answerBtn;
}

// --- Derni√®re activit√© ---
if(lastActivity){
  const last = new Date(lastActivity);
  console.log("Derni√®re activit√© enregistr√©e :", last.toLocaleString());
}
</script>

</body>
</html>