<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Interactif √âducatif</title>
<style>
body { font-family: Arial,sans-serif; margin:0; padding:0; background: linear-gradient(-45deg,#1e3c72,#2a5298,#f6d365,#fda085); background-size:400% 400%; animation: gradientBG 15s ease infinite; color:#fff; }
@keyframes gradientBG {0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
header { text-align:center; padding:20px; }
#datetime { font-size:1.1em; margin-top:5px; }
main { max-width:700px; margin:0 auto; padding:20px; background:rgba(0,0,0,0.4); border-radius:15px; }
section { margin-bottom:20px; padding:15px; background:rgba(255,255,255,0.1); border-radius:10px; }
select, button, input { padding:10px; margin-top:10px; border:none; border-radius:10px; font-weight:bold; }
button { background:#ff7f50; color:#fff; cursor:pointer; transition:0.3s; }
button:hover { background:#ff4500; transform:scale(1.05); }
input { width:60%; margin-right:10px; }
#quizContainer { margin-top:20px; }
#result { font-weight:bold; font-size:1.2em; margin-top:10px; }
.correct { color:lightgreen; animation: blink 0.5s; }
.incorrect { color:orange; animation: blink 0.5s; }
@keyframes blink { 0%{opacity:0.2} 50%{opacity:1} 100%{opacity:0.2} }

/* Popup mauvaise r√©ponse */
#wrongAnswerPopup {
  display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
  background:rgba(0,0,0,0.7); justify-content:center; align-items:center; z-index:1000;
}
#wrongAnswerPopup div {
  background:#fff; color:#000; padding:20px; border-radius:10px; max-width:400px; text-align:center;
}
#wrongAnswerPopup button {
  padding:10px 20px; border:none; border-radius:10px; background:#ff7f50; color:#fff; cursor:pointer;
}

/* Iframe paiement */
#paymentFrame { display:none; width:100%; height:400px; border:none; margin-top:20px; }
</style>
</head>
<body>

<header>
<h1 id="siteTitle">üìö Quiz Interactif</h1>
<p id="datetime"></p>
<label id="langLabel" for="langSelect">Langue :</label>
<select id="langSelect" onchange="updateLanguage()">
  <option value="fr">Fran√ßais</option>
  <option value="en">English</option>
  <option value="es">Espa√±ol</option>
  <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
</select>
</header>

<main>
<section id="selection">
<h2 id="selectTitle">Choisir Classe et Mati√®re</h2>
<label id="classeLabel" for="classeSelect">Classe :</label>
<select id="classeSelect">
  <option value="">--Choisir une classe--</option>
  <option value="CM2">CM2</option>
</select>
<label id="matiereLabel" for="matiereSelect">Mati√®re :</label>
<select id="matiereSelect">
  <option value="">--Choisir une mati√®re--</option>
  <option value="Math√©matiques">Math√©matiques</option>
</select>
</section>

<section id="coursSection">
<h2 id="coursTitle">üí° Cours</h2>
<div id="coursList"></div>
</section>

<section id="quizSection">
<h2 id="quizTitle">üìù Question</h2>
<div id="quizContainer">
  <p id="questionText"></p>
  <input type="text" id="answerInput" placeholder="">
  <button id="answerBtn" onclick="submitAnswer()">R√©pondre</button>
  <p id="result"></p>
</div>
<button id="continueBtn" style="display:none;" onclick="showPayment()">Payer pour continuer</button>
<iframe id="paymentFrame" src="https://www.my-coolpay.com/pay/ciWsFgwN"></iframe>
<label for="paymentIdInput">ID de transaction :</label>
<input type="text" id="paymentIdInput" placeholder="Coller l'ID ici">
<button onclick="verifyPayment()">V√©rifier</button>
</section>
</main>

<footer>
&copy; 2025 Mon Site √âducatif
</footer>

<div id="wrongAnswerPopup">
  <div>
    <p id="correctAnswerText"></p>
    <button onclick="closeWrongAnswerPopup()">Fermer</button>
  </div>
</div>

<script>
// Heure et date
function updateDateTime(){
  const now = new Date();
  document.getElementById('datetime').innerText = now.toLocaleDateString('fr-FR',{weekday:'long',year:'numeric',month:'long',day:'numeric'})+' | '+now.toLocaleTimeString('fr-FR');
}
setInterval(updateDateTime,1000);

// Donn√©es
const coursData = { "CM2":{"Math√©matiques":["Addition","Soustraction"]} };
let currentQuiz = [];
let currentIndex = 0;
let MAX_QUESTIONS_BEFORE_PAYMENT = 2;

// Textes multilingues
const texts = {
  fr: { siteTitle:"üìö Quiz Interactif", selectTitle:"Choisir Classe et Mati√®re", classe:"Classe :", matiere:"Mati√®re :", coursTitle:"üí° Cours", quizTitle:"üìù Question", answerPlaceholder:"Votre r√©ponse", answerBtn:"R√©pondre", completeMsg:"üéâ Quiz termin√© !"},
  en: { siteTitle:"üìö Interactive Quiz", selectTitle:"Select Class and Subject", classe:"Class :", matiere:"Subject :", coursTitle:"üí° Lessons", quizTitle:"üìù Question", answerPlaceholder:"Your answer", answerBtn:"Submit", completeMsg:"üéâ Quiz Finished!"},
  es: { siteTitle:"üìö Quiz Interactivo", selectTitle:"Elegir Clase y Materia", classe:"Clase :", matiere:"Materia :", coursTitle:"üí° Cursos", quizTitle:"üìù Pregunta", answerPlaceholder:"Tu respuesta", answerBtn:"Responder", completeMsg:"üéâ ¬°Quiz Terminado!"},
  ar: { siteTitle:"üìö ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ™ŸÅÿßÿπŸÑŸä", selectTitle:"ÿßÿÆÿ™ÿ± ÿßŸÑÿµŸÅ ŸàÿßŸÑŸÖÿßÿØÿ©", classe:"ÿßŸÑÿµŸÅ :", matiere:"ÿßŸÑŸÖÿßÿØÿ© :", coursTitle:"üí° ÿßŸÑÿØÿ±Ÿàÿ≥", quizTitle:"üìù ÿßŸÑÿ≥ÿ§ÿßŸÑ", answerPlaceholder:"ÿ•ÿ¨ÿßÿ®ÿ™ŸÉ", answerBtn:"ÿ£ÿ¨ÿ®", completeMsg:"üéâ ÿßŸÜÿ™ŸáŸâ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±!"}
};

// Quiz multilingue
const quizBank = { 
  "CM2": { 
    "Math√©matiques":[
      {q:{fr:"Combien font 7 + 5 ?", en:"What is 7 + 5?", es:"¬øCu√°nto es 7 + 5?", ar:"ŸÉŸÖ Ÿäÿ≥ÿßŸàŸä 7 + 5ÿü"}, a:"12"},
      {q:{fr:"Combien font 2 + 3 ?", en:"What is 2 + 3?", es:"¬øCu√°nto es 2 + 3?", ar:"ŸÉŸÖ Ÿäÿ≥ÿßŸàŸä 2 + 3ÿü"}, a:"5"},
      {q:{fr:"Combien font 10 - 4 ?", en:"What is 10 - 4?", es:"¬øCu√°nto es 10 - 4?", ar:"ŸÉŸÖ Ÿäÿ≥ÿßŸàŸä 10 - 4ÿü"}, a:"6"},
      {q:{fr:"Combien font 3 x 2 ?", en:"What is 3 x 2?", es:"¬øCu√°nto es 3 x 2?", ar:"ŸÉŸÖ Ÿäÿ≥ÿßŸàŸä 3 √ó 2ÿü"}, a:"6"}
    ] 
  } 
};  

// Sauvegarde et r√©cup√©ration m√©moire locale
function saveState(){
  const state = {
    currentIndex: currentIndex,
    lang: document.getElementById('langSelect').value,
    paymentDone: document.getElementById('paymentFrame').style.display === "none"
  };
  localStorage.setItem('quizState', JSON.stringify(state));
}
function loadState(){
  const saved = JSON.parse(localStorage.getItem('quizState'));
  if(saved){
    currentIndex = saved.currentIndex || 0;
    document.getElementById('langSelect').value = saved.lang || 'fr';
    updateLanguage();
    if(saved.paymentDone){
      document.getElementById('paymentFrame').style.display = "none";
      document.getElementById('continueBtn').style.display = "none";
    } else if(currentIndex >= MAX_QUESTIONS_BEFORE_PAYMENT){
      document.getElementById('quizContainer').style.display = "none";
      document.getElementById('continueBtn').style.display = "block";
    }
  }
}

// D√©marrer quiz
document.getElementById('classeSelect').addEventListener('change', startQuizIfSelected);
document.getElementById('matiereSelect').addEventListener('change', startQuizIfSelected);

function startQuizIfSelected(){
  const classe = document.getElementById('classeSelect').value;
  const matiere = document.getElementById('matiereSelect').value;
  if(!classe || !matiere) return;

  const coursList = document.getElementById('coursList');
  coursList.innerHTML = "";
  (coursData[classe][matiere]||[]).forEach(c => { const div=document.createElement('div'); div.innerText=c; coursList.appendChild(div); });

  currentQuiz = quizBank[classe][matiere];
  showQuestion();
}

function showQuestion(){
  saveState();
  if(currentIndex >= currentQuiz.length){
    document.getElementById('quizContainer').innerHTML = texts[document.getElementById('langSelect').value].completeMsg;
    return;
  }
  if(currentIndex === MAX_QUESTIONS_BEFORE_PAYMENT){
    document.getElementById('quizContainer').style.display = "none";
    document.getElementById('continueBtn').style.display = "block";
    return;
  }
  const lang = document.getElementById('langSelect').value;
  document.getElementById('questionText').innerText = currentQuiz[currentIndex].q[lang];
  document.getElementById('answerInput').value = "";
  document.getElementById('answerInput').placeholder = texts[lang].answerPlaceholder;
  document.getElementById('answerBtn').innerText = texts[lang].answerBtn;
  document.getElementById('quizContainer').style.display= "block";
  document.getElementById('result').innerText = "";
}

// Soumission r√©ponse
function submitAnswer(){
  const answer = document.getElementById('answerInput').value.trim().toLowerCase();
  const correct = currentQuiz[currentIndex].a.toLowerCase();
  const resultEl = document.getElementById('result');

  if(answer === correct){
    resultEl.innerText = "‚úÖ Correct !";
    resultEl.className = "correct";
  } else {
    resultEl.innerText = "‚ùå Incorrect !";
    resultEl.className = "incorrect";
    document.getElementById('correctAnswerText').innerText = `La bonne r√©ponse est : ${currentQuiz[currentIndex].a}`;
    document.getElementById('wrongAnswerPopup').style.display = "flex";
  }

  currentIndex++;
  saveState();

  setTimeout(showQuestion, 1000);
}

// Fermer popup mauvaise r√©ponse
function closeWrongAnswerPopup(){
  document.getElementById('wrongAnswerPopup').style.display = "none";
}

// Multilingue
function updateLanguage(){
  const lang = document.getElementById('langSelect').value;
  document.getElementById('siteTitle').innerText = texts[lang].siteTitle;
  document.getElementById('selectTitle').innerText = texts[lang].selectTitle;
  document.getElementById('classeLabel').innerText = texts[lang].classe;
  document.getElementById('matiereLabel').innerText = texts[lang].matiere;
  document.getElementById('coursTitle').innerText = texts[lang].coursTitle;
  document.getElementById('quizTitle').innerText = texts[lang].quizTitle;
  document.getElementById('answerInput').placeholder = texts[lang].answerPlaceholder;
  document.getElementById('answerBtn').innerText = texts[lang].answerBtn;
  saveState();
}

// Afficher iframe paiement
function showPayment(){
  document.getElementById('paymentFrame').style.display = "block";
  document.getElementById('continueBtn').style.display = "none";
}

// V√©rification du paiement (simulation)
function verifyPayment(){
  const paymentId = document.getElementById('paymentIdInput').value.trim();
  if(paymentId.length > 0){
    alert(`Paiement v√©rifi√© ! ID : ${paymentId}\nAcc√®s d√©bloqu√© pour continuer le quiz.`);
    document.getElementById('paymentFrame').style.display = "none";
    document.getElementById('quizContainer').style.display = "block";
    saveState();
  } else {
    alert("Veuillez entrer un ID de transaction valide.");
  }
}

// Charger l'√©tat sauvegard√© au lancement
window.onload = function(){
  updateDateTime();
  loadState();
};
</script>
</body>
</html>