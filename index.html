<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Biblioth√®que Num√©rique</title>
<style>
/* --- Styles globaux --- */
body {
  font-family: Arial, sans-serif;
  margin:0;
  padding:0;
  background: linear-gradient(-45deg, #ff9a9e, #fad0c4, #a1c4fd, #c2e9fb);
  background-size: 400% 400%;
  animation: gradientBG 15s ease infinite;
  color: #fff;
}
@keyframes gradientBG {
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
header {
  background: rgba(0,0,0,0.6);
  padding: 10px;
  display: flex;
  flex-direction: column;
  gap:5px;
  position: sticky;
  top:0;
  z-index:1000;
}
nav {
  display:flex;
  justify-content:space-between;
  align-items:center;
}
nav a {
  margin:0 10px;
  color:#fff;
  text-decoration:none;
  font-weight:bold;
}
.clock {font-weight:bold;}
.user-info {
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.status-btn {
  padding:5px 10px;
  border:none;
  border-radius:5px;
  font-weight:bold;
  color:#fff;
}
.status-ferme {background:gray;}
.status-simple {background:green;}
.status-premium {background:deepskyblue;}
.status-admin {background:orange;}
.banner {
  background: rgba(0,0,0,0.6);
  overflow:hidden;
  white-space: nowrap;
  padding:5px 0;
}
.banner span {
  display: inline-block;
  padding-left:100%;
  animation: scrollBanner 15s linear infinite;
}
@keyframes scrollBanner {
  0% {transform: translateX(0);}
  100% {transform: translateX(-100%);}
}
main {padding:20px;}
.books {display:grid; grid-template-columns: repeat(auto-fit,minmax(150px,1fr)); gap:20px;}
.book {
  background: rgba(0,0,0,0.5);
  padding:10px;
  border-radius:10px;
  cursor:pointer;
  transition: transform 0.3s;
}
.book:hover {transform: scale(1.05);}
.pages {margin-top:10px; display:none;}
.page {
  background: rgba(255,255,255,0.9);
  color:#000;
  padding:15px;
  margin:5px 0;
  border-radius:8px;
  cursor:pointer;
  transition: background 0.3s;
}
.page:hover {background:#e0e0e0;}
.popup-bg {
  position:fixed;
  top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.7);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:2000;
}
.popup {
  background:#fff;
  color:#000;
  padding:20px;
  border-radius:10px;
  max-width:300px;
  text-align:center;
}
.admin-table {
  width:100%;
  border-collapse:collapse;
  margin-top:20px;
  display:none;
}
.admin-table th, .admin-table td {border:1px solid #fff; padding:8px;}
.admin-table th {background:rgba(255,255,255,0.2);}
</style>
</head>
<body>

<header>
  <nav>
    <div class="logo">üìö Biblioth√®que Num√©rique</div>
    <div>
      <a href="#books">Livres</a>
      <a href="#admin">Admin</a>
    </div>
    <div class="clock" id="clock"></div>
  </nav>
  <div class="user-info">
    <div>ID : <span id="userId"></span></div>
    <div>Statut : <button class="status-btn" id="userStatus"></button></div>
    <div>Livre s√©lectionn√© : <span id="selectedBook">Aucun</span></div>
  </div>
</header>

<div class="banner">
  <span>üéâ Nouvelle offre premium disponible ! Contactez l'admin pour plus d'infos. üéâ</span>
</div>

<main>
  <section id="books">
    <h2>Nos Livres</h2>
    <div class="books" id="booksContainer"></div>
  </section>

  <section id="admin">
    <h2>Tableau Administrateur</h2>
    <button onclick="adminLogin()">Acc√©der</button>
    <table class="admin-table" id="adminTable">
      <thead>
        <tr>
          <th>ID Utilisateur</th>
          <th>Type</th>
          <th>Date D√©but</th>
          <th>Date Fin</th>
          <th>Livres Autoris√©s</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>
</main>

<div class="popup-bg" id="popupBg">
  <div class="popup" id="popupContent">
    <p>Acc√®s r√©serv√© aux abonn√©s !</p>
    <p>Prix : 500 FCFA / Contact : admin@example.com</p>
    <button onclick="closePopup()">Fermer</button>
  </div>
</div>

<script>
  // --- Horloge en direct ---
  function updateClock() {
    const now = new Date();
    document.getElementById('clock').textContent =
      now.toLocaleDateString('fr-FR') + ' ' + now.toLocaleTimeString('fr-FR');
  }
  setInterval(updateClock,1000);
  updateClock();

  // --- Donn√©es livres ---
  const booksData = [
    {id:0,title:'Livre 1',pages:['Page 1 du Livre 1','Page 2 du Livre 1','Page 3 du Livre 1']},
    {id:1,title:'Livre 2',pages:['Page 1 du Livre 2','Page 2 du Livre 2']},
    {id:2,title:'Livre 3',pages:['Page 1 du Livre 3','Page 2 du Livre 3']}
  ];

  // --- Donn√©es utilisateurs ---
  let users = [
    {id:'U1001',type:'premium',start:'01/09/2025',end:'30/09/2025',books:[0]}, 
    {id:'U1002',type:'simple',start:'01/09/2025',end:'30/09/2025',books:[0]}, 
    {id:'U1001',type:'admin',start:'01/01/2025',end:'31/12/2030',books:[0,1,2]}
  ];

  // --- S√©lection utilisateur connect√© (test) ---
  let currentUser = users[0]; // Remplacer par login r√©el
  document.getElementById('userId').textContent = currentUser.id;

  function updateStatusButton(){
    const btn = document.getElementById('userStatus');
    btn.textContent = currentUser.type.toUpperCase();
    btn.className = 'status-btn ' + 
      (currentUser.type==='ferme'?'status-ferme':currentUser.type==='simple'?'status-simple':currentUser.type==='premium'?'status-premium':'status-admin');
  }
  updateStatusButton();

  // --- V√©rification automatique du statut selon la date ---
  function updateUserStatus(){
    const today = new Date();
    const start = new Date(currentUser.start.split('/').reverse().join('-'));
    const end = new Date(currentUser.end.split('/').reverse().join('-'));
    if(currentUser.type!=='admin'){
      if(today<start || today>end) currentUser.type='ferme';
    }
    updateStatusButton();
  }
  updateUserStatus();

  // --- G√©n√©ration des livres ---
  const booksContainer = document.getElementById('booksContainer');
  booksData.forEach(book=>{
    const bookDiv = document.createElement('div');
    bookDiv.className='book';
    bookDiv.dataset.bookId=book.id;
    bookDiv.innerHTML = `<h3>${book.title}</h3><div class="pages"></div>`;
    booksContainer.appendChild(bookDiv);

    const pagesDiv = bookDiv.querySelector('.pages');
    book.pages.forEach((p,pageIndex)=>{
      const pageEl = document.createElement('div');
      pageEl.className='page';
      pageEl.textContent = p;
      pageEl.onclick = (e)=>{
        e.stopPropagation();
        if(canAccessBook(currentUser,book.id)){
          alert(p);
        } else {
          showPopup();
        }
      };
      pagesDiv.appendChild(pageEl);
    });

    bookDiv.onclick = ()=>{
      document.getElementById('selectedBook').textContent = book.title;
      pagesDiv.style.display = pagesDiv.style.display==='block'?'none':'block';
      if(!canAccessBook(currentUser,book.id)) showPopup();
    };
  });

  // --- V√©rification acc√®s ---
  function canAccessBook(user,bookId){
    if(user.type==='admin' || user.type==='premium') return true;
    if(user.type==='simple') return user.books.includes(bookId);
    return false; // ferm√©
  }

  // --- Popup ---
  function showPopup(){document.getElementById('popupBg').style.display='flex';}
  function closePopup(){document.getElementById('popupBg').style.display='none';}

  // --- Tableau Admin ---
  const adminPassword = "233233";
  function adminLogin(){
    const code = prompt("Entrez le code d'acc√®s administrateur :");
    if(code===adminPassword){
      const tbody = document.getElementById('adminTable').querySelector('tbody');
      tbody.innerHTML = '';
      users.forEach(u=>{
        const tr = document.createElement('tr');
        tr.innerHTML=`<td>${u.id}</td>
                      <td>${u.type}</td>
                      <td>${u.start}</td>
                      <td>${u.end}</td>
                      <td>${u.books.map(b=>booksData[b].title).join(', ')}</td>`;
        tbody.appendChild(tr);
      });
      document.getElementById('adminTable').style.display='table';
    } else {
      alert('Code incorrect !');
    }
  }

</script>

</body>
</html>